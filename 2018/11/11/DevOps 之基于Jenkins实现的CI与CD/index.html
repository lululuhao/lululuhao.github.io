<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Apologize" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="DevOps 之基于Jenkins实现的CI与CD">
<meta property="og:type" content="article">
<meta property="og:title" content="DevOps">
<meta property="og:url" content="http://yoursite.com/2018/11/11/DevOps 之基于Jenkins实现的CI与CD/index.html">
<meta property="og:site_name" content="Apologize">
<meta property="og:description" content="DevOps 之基于Jenkins实现的CI与CD">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/001.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/001.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/002.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/003.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/004.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/005.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/006.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552470496064.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552471728487.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552471841495.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552471871730.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472028289.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472104713.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472112782.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472121857.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472136817.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472153118.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472164158.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472174867.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472184685.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472194997.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472207852.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472215518.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472226651.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472238523.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472247536.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472273557.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472288402.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472296901.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472307531.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472318834.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472328177.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472346885.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472360149.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472367128.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472522711.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552472512837.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552635507551.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552548720334.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552548757681.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552628612457.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552625864421.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552642826794.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552642838623.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552642848919.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552642861246.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552642970678.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/1552642902559.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552642983156.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552642990899.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643006981.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643017898.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643030371.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643037904.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643054619.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643075784.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643101167.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643120269.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552648275024.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552647914080.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643144924.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643154495.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552648051153.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552648342809.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643193611.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643209319.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643219014.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643230054.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643240019.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643253854.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643289387.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643308322.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643338278.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643352409.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643361258.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552649610425.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643372081.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643383906.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643394758.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552643405100.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552654945805.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552654519301.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552654828341.png">
<meta property="og:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/5C1552654976723.png">
<meta property="og:updated_time" content="2019-04-12T03:05:49.842Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DevOps">
<meta name="twitter:description" content="DevOps 之基于Jenkins实现的CI与CD">
<meta name="twitter:image" content="http://yoursite.com/2018/11/11/DevOps%20之基于Jenkins实现的CI与CD/img/001.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> DevOps | Apologize </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Apologize</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                DevOps
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-11-11T18:18:18+08:00" content="2018-11-11">
              2018-11-11
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="DevOps-之基于Jenkins实现的CI与CD"><a href="#DevOps-之基于Jenkins实现的CI与CD" class="headerlink" title="DevOps 之基于Jenkins实现的CI与CD"></a>DevOps 之基于Jenkins实现的CI与CD</h1><p> <img src="img/001.png" alt="1552469963552"></p>
<a id="more"></a>
<p>DevOps简介：</p>
<p>DevOps 是Development和Operations的组合，也就是开发和运维的简写。</p>
<p>DevOps 是针对企业中的研发人员、运维人员和测试人员的工作理念，是他们在应用开发、代码部署和质量测试等整条生命周期中协作和沟通的最佳实践，DevOps 强调整个组织的合作以及交付和基础设施变更的自动化、从而实现持续集成、持续部署和持续交付。</p>
<p>DevOps 四大平台：代码托管(gitlab/svn)、项目管理(jira)、运维平台(腾讯蓝鲸/开源平台)、持续交付(Jenkins/gitlab)</p>
<h2 id="1-1：什么是DevOps："><a href="#1-1：什么是DevOps：" class="headerlink" title="1.1：什么是DevOps："></a>1.1：什么是DevOps：</h2><p>​                                                  <img src="img\001.png" alt="1552469963552"></p>
<h2 id="1-2：为什么要推广DevOps？"><a href="#1-2：为什么要推广DevOps？" class="headerlink" title="1.2：为什么要推广DevOps？"></a>1.2：为什么要推广DevOps？</h2><p>DevOps 强调团队协作、相互协助、持续发展，然而传统的模式是开发人员只顾开发程序，运维只负责基础环境管理和代码部署及监控等，其并不是为了一个共同的目标而共同实现最终的目的，而DevOps 则实现团队作战，即无论是开发、运维还是测试，都为了最终的代码发布、持续部署和业务稳定而付出各自的努力，从而实现产品设计、开发、测试和部署的良性循环，实现产品的最终持续交付。</p>
<p>   <img src="img/002.png" alt="1552470014252"></p>
<h2 id="1-3：传统技术团队："><a href="#1-3：传统技术团队：" class="headerlink" title="1.3：传统技术团队："></a>1.3：传统技术团队：</h2><p> <img src="img/003.png" alt="1552470031419"></p>
<h2 id="1-4：DevOps技术团队："><a href="#1-4：DevOps技术团队：" class="headerlink" title="1.4：DevOps技术团队："></a>1.4：DevOps技术团队：</h2><p>​        </p>
<p>​          戴明环          </p>
<p><img src="img/004.png" alt="1552470031419"></p>
<h2 id="1-5：什么是持续集成-CI-Continuous-integration-："><a href="#1-5：什么是持续集成-CI-Continuous-integration-：" class="headerlink" title="1.5：什么是持续集成(CI-Continuous integration)："></a>1.5：什么是持续集成(CI-Continuous integration)：</h2><p>持续集成是指多名开发者在开发不同功能代码的过程当中，可以频繁的将代码行合并到一起并切相互不影响工作。</p>
<h2 id="1-6：什么是持续部署-CD-continuous-deployment-："><a href="#1-6：什么是持续部署-CD-continuous-deployment-：" class="headerlink" title="1.6：什么是持续部署(CD-continuous deployment)："></a>1.6：什么是持续部署(CD-continuous deployment)：</h2><p>是基于某种工具或平台实现代码自动化的构建、测试和部署到线上环境以实现交付高质量的产品,持续部署在某种程度上代表了一个开发团队的更新迭代速率。</p>
<h2 id="1-7：什么是持续交付-Continuous-Delivery-："><a href="#1-7：什么是持续交付-Continuous-Delivery-：" class="headerlink" title="1.7：什么是持续交付(Continuous Delivery)："></a>1.7：什么是持续交付(Continuous Delivery)：</h2><p>持续交付是在持续部署的基础之上，将产品交付到线上环境，因此持续交付是产品价值的一种交付，是产品价值的一种盈利的实现。</p>
<p><img src="img/005.png" alt="1552738200584"></p>
<h2 id="1-8：常见的部署方式："><a href="#1-8：常见的部署方式：" class="headerlink" title="1.8：常见的部署方式："></a>1.8：常见的部署方式：</h2><p>开发自己上传–最原始的方案</p>
<p>开发给运维手动上传–运维自己手动部署</p>
<p>运维使用脚本复制–半自动化</p>
<p>结合web界面一键部署–自动化</p>
<h2 id="1-9：常见的持续集成开源工具："><a href="#1-9：常见的持续集成开源工具：" class="headerlink" title="1.9：常见的持续集成开源工具："></a>1.9：常见的持续集成开源工具：</h2><p>在公司的服务器安装某种程序，该程序用于按照特定格式和方式记录和保存公司多名开发人员不定期提交的源代码，且后期可以按照某种标记及方式对用户提交的数据进行还原。</p>
<h3 id="1-9-1：CVS-Concurrent-Version-System-："><a href="#1-9-1：CVS-Concurrent-Version-System-：" class="headerlink" title="1.9.1：CVS(Concurrent Version System)："></a>1.9.1：CVS(Concurrent Version System)：</h3><p>早期的集中式版本控制系统，现已基本淘汰</p>
<p>会出现数据提交后不完整的情况</p>
<h3 id="1-9-2：SVN-Subversion-–集中式版本控制系统"><a href="#1-9-2：SVN-Subversion-–集中式版本控制系统" class="headerlink" title="1.9.2：SVN(Subversion)–集中式版本控制系统"></a>1.9.2：SVN(Subversion)–集中式版本控制系统</h3><p>2000年开始开发，目标就是替代CVS集中式管理，依赖于网络，一台服务器集中管理目前依然有部分公司在使用。</p>
<h3 id="1-9-3：Gitlib—分布式版本控制系统"><a href="#1-9-3：Gitlib—分布式版本控制系统" class="headerlink" title="1.9.3：Gitlib—分布式版本控制系统"></a>1.9.3：Gitlib—分布式版本控制系统</h3><p>Linus在1991年创建了开源的Linux内核，从此Linux便不断快速发展，不过 Linux的壮大是离不开全世界的开发者的参与，这么多人在世界各地为Linux编写代码，那Linux内核的代码是如何管理的呢？事实是，在2002年以前，世界各地的志愿者把源代码文件通过diff的方式发给Linus，然后由Linus本人通过手工方式合并代码！你也许会想，为什么Linus不把Linux代码放到版本控制系统里呢？不是有CVS、SVN这些免费的版本控制系统吗？因为Linus坚定地反对CVS和SVN，这些集中式的版本控制系统不但速度慢，且必须联网才能使用，但是也有一些商用的版本控制系统，虽然比CVS、SVN好用，但那是付费的，和Linux的开源精神不符,不过，到了2002年，Linux系统已经发展了十年了，代码库之大让Linus很难继续通过手工方式管理了，社区的弟兄们也对这种方式表达了强烈不满，于是Linus选择了一个商业的版本控制系统BitKeeper，BitKeeper的东家BitMover公司出于人道主义精神，授权Linux社区免费使用这个版本控制系统,但是安定团结的大好局面在2005年就被打破了，原因是Linux社区牛人聚集，不免沾染了一些梁山好汉的江湖习气，开发Samba的Andrew试图破解BitKeeper的协议（这么干的其实也不只他一个），被BitMover公司发现了（监控工作做得不错！），于是BitMover公司怒了，要收回Linux社区的免费使用权,这时候其实Linus可以向BitMover公司道个歉，保证以后严格管教弟兄们，但这是不可能的，而且实际情况是Linus自己花了两周时间自己用C写了一个分布式版本控制系统，这就是Git！一个月之内，Linux内核的源码已经由Git管理了！牛是怎么定义的呢？大家可以体会一下,然后Git迅速成为最流行的分布式版本控制系统，尤其是2008年，GitHub网站上线了，它为开源项目免费提供Git存储，无数开源项目开始迁移至GitHub，包括jQuery，PHP，Ruby等等。</p>
<p>   <img src="img/006.png" alt="1552470485535"></p>
<p>​        <img src="img/5C1552470496064.png" alt="1552470496064"></p>
<h2 id="1-10：版本控制系统分类："><a href="#1-10：版本控制系统分类：" class="headerlink" title="1.10：版本控制系统分类："></a>1.10：版本控制系统分类：</h2><h3 id="1-10-1：集中式版本控制系统："><a href="#1-10-1：集中式版本控制系统：" class="headerlink" title="1.10.1：集中式版本控制系统："></a>1.10.1：集中式版本控制系统：</h3><p>任何的提交和回滚都依赖于连接服务器服务器是单点</p>
<p><img src="img/5C1552471728487.png" alt="1552471728487"></p>
<h3 id="1-10-2：分布式版本控制系统："><a href="#1-10-2：分布式版本控制系统：" class="headerlink" title="1.10.2：分布式版本控制系统："></a>1.10.2：分布式版本控制系统：</h3><p>​                        </p>
<p>​              http/https/ssh/git              </p>
<p>Git在每个用户都有一个完整的服务器，然后在有一个中央服务器，用户可以先将代码提交到本地，没有网络也可以先提交到本地，然后在有网络的时候再提交到中央服务器，这样就大大方便了开发者，而相比CVS和SVN都是集中式的版本控制系统，工作的时候需要先从中央服务器获取最新的代码，改完之后需要提交，如果是一个比较大的文件则需要足够快的网络才能快速提交完成，而使用分布式的版本控制系统，每个用户都是一个完整的版本库，即使没有中央服务器也可以提交代码或者回滚，最终再把改好的代码提交至中央服务器进行合并即可。</p>
<p><img src="img/5C1552471841495.png" alt="1552471841495"></p>
<h1 id="二：Gitlab部署与使用："><a href="#二：Gitlab部署与使用：" class="headerlink" title="二：Gitlab部署与使用："></a>二：Gitlab部署与使用：</h1><h2 id="2-1：下载并部署gitlab："><a href="#2-1：下载并部署gitlab：" class="headerlink" title="2.1：下载并部署gitlab："></a>2.1：下载并部署gitlab：</h2><h3 id="2-1-1：Ubuntu-系统环境准备："><a href="#2-1-1：Ubuntu-系统环境准备：" class="headerlink" title="2.1.1：Ubuntu 系统环境准备："></a>2.1.1：Ubuntu 系统环境准备：</h3><h4 id="2-1-1-1：配置ubuntu-远程连接："><a href="#2-1-1-1：配置ubuntu-远程连接：" class="headerlink" title="2.1.1.1：配置ubuntu 远程连接："></a>2.1.1.1：配置ubuntu 远程连接：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jack@ubuntu:~$ sudo su - root</span><br><span class="line">[sudo] password <span class="keyword">for</span> jack:</span><br><span class="line">root@ubuntu:~<span class="comment"># passwd  </span></span><br><span class="line">Enter new UNIX password: </span><br><span class="line">Retype new UNIX password: </span><br><span class="line">passwd: password updated successfully</span><br><span class="line">root@ubuntu:~<span class="comment"># vim /etc/ssh/sshd_config</span></span><br></pre></td></tr></table></figure>
<p> <img src="img/5C1552471871730.png" alt="1552471871730"></p>
<h4 id="2-1-1-2：配置ubuntu网卡和主机名："><a href="#2-1-1-2：配置ubuntu网卡和主机名：" class="headerlink" title="2.1.1.2：配置ubuntu网卡和主机名："></a>2.1.1.2：配置ubuntu网卡和主机名：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># cat  /etc/netplan/01-netcfg.yaml </span></span><br><span class="line"></span><br><span class="line">\<span class="comment"># This file describes the network interfaces available on your system</span></span><br><span class="line"></span><br><span class="line">\<span class="comment"># For more information, see netplan(5).</span></span><br><span class="line"></span><br><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line">  ethernets:</span><br><span class="line">    eth0:</span><br><span class="line">      dhcp4: no</span><br><span class="line">      addresses: [192.168.8.2/21]</span><br><span class="line">      gateway4: 192.168.15.254</span><br><span class="line">      nameservers:</span><br><span class="line">        addresses: [192.168.15.254]</span><br><span class="line">root@ubuntu:~<span class="comment"># cat /etc/hostname </span></span><br><span class="line">jenkins.example.com</span><br><span class="line">root@ubuntu:~<span class="comment"># reboot</span></span><br></pre></td></tr></table></figure>
<h4 id="2-1-1-3：配置ubuntu-仓库："><a href="#2-1-1-3：配置ubuntu-仓库：" class="headerlink" title="2.1.1.3：配置ubuntu 仓库："></a>2.1.1.3：配置ubuntu 仓库：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment">#vim  /etc/apt/sources.list</span></span><br><span class="line"></span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse</span><br><span class="line"></span><br><span class="line">root@jenkins:~<span class="comment"># apt  update</span></span><br><span class="line">root@jenkins:~<span class="comment"># apt install iproute2  ntpdate  tcpdump telnet traceroute nfs-kernel-server nfs-common  lrzsz tree  openssl libssl-dev libpcre3 libpcre3-dev zlib1g-dev ntpdate tcpdump telnet traceroute  gcc openssh-server lrzsz tree openssl libssl-dev libpcre3 libpcre3-dev zlib1g-dev ntpdate tcpdump telnet traceroute iotop unzip zip ipmitool</span></span><br></pre></td></tr></table></figure>
<h3 id="2-1-2：Centos-系统环境在准备："><a href="#2-1-2：Centos-系统环境在准备：" class="headerlink" title="2.1.2：Centos 系统环境在准备："></a>2.1.2：Centos 系统环境在准备：</h3><ul>
<li>1 gitlab-server    172.20.102.205</li>
<li>2 jenkins-server   172.20.102.222</li>
<li>3 tomcat-web1      172.20.102.228</li>
<li>4 tomcat-web2      172.20.102.240</li>
<li>5 keepalived+haproxy1         172.20.102.216</li>
<li>6 keepalived+haproxy2         172.20.102.253</li>
</ul>
<p>最小化服务器安装，配置如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\<span class="comment"># yum install vim gcc gcc-c++ wget net-tools lrzsz iotop lsof iotop bash-completion -y`</span></span><br></pre></td></tr></table></figure>
<p># yum install curl policycoreutils openssh-server openssh-clients postfix -y<br># wget -O /etc/yum.repos.d/epel.repo <a href="http://mirrors.aliyun.com/repo/epel-7.repo">http://mirrors.aliyun.com/repo/epel-7.repo</a><br># systemctl disable firewalld<br># sed -i ‘/SELINUX/s/enforcing/disabled/‘ /etc/sysconfig/selinux<br># hostnamectl set-hostname gitlab.example.com<br># reboot<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">### 2.1.3：gitlab安装及使用：</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">安装包下载地址：https://packages.gitlab.com/gitlab/gitlab-ce   </span><br><span class="line">rpm包国内下载地址：https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/ </span><br><span class="line">本次安装版本为gitlab-ce-11.3.11-ce.0.el7.x86_64.rpm</span><br><span class="line"># wget https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/gitlab-ce-11.3.11-ce.0.el7.x86_64.rpm</span><br><span class="line"># rpm -ivh gitlab-ce-11.3.11-ce.0.el7.x86_64.rpm</span><br></pre></td></tr></table></figure></p>
<p> <img src="img/5C1552472028289.png" alt="1552472028289"></p>
<h4 id="2-1-3-1：gitlab配置："><a href="#2-1-3-1：gitlab配置：" class="headerlink" title="2.1.3.1：gitlab配置："></a>2.1.3.1：gitlab配置：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@gitlab ~]<span class="comment">#grep "^[a-Z]" /etc/gitlab/gitlab.rb</span></span><br><span class="line">external_url <span class="string">'http://192.168.245.17'</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_enable'</span>] = <span class="literal">true</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_address'</span>] = <span class="string">"smtp.163.com"</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_port'</span>] = 25</span><br><span class="line">gitlab_rails[<span class="string">'smtp_user_name'</span>] = <span class="string">"htluhao@163.com"</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_password'</span>] = <span class="string">"luhao111"</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_domain'</span>] = <span class="string">"163.com"</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_authentication'</span>] = :login</span><br><span class="line">gitlab_rails[<span class="string">'smtp_enable_starttls_auto'</span>] = <span class="literal">true</span></span><br><span class="line">gitlab_rails[<span class="string">'smtp_tls'</span>] = <span class="literal">false</span></span><br><span class="line">gitlab_rails[<span class="string">'gitlab_email_from'</span>] = <span class="string">"htluhao@163.com"</span></span><br><span class="line">user[<span class="string">"git_user_email"</span>] = [htluhao@163.com</span><br></pre></td></tr></table></figure>
<h4 id="2-1-3-2：初始化服务："><a href="#2-1-3-2：初始化服务：" class="headerlink" title="2.1.3.2：初始化服务："></a>2.1.3.2：初始化服务：</h4><p>执行配置并启动服务：</p>
<p>`# gitlab-ctl  reconfigure #修改完配置文件要执行此操作`</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\<span class="comment"># gitlab-ctl  start</span></span><br><span class="line"></span><br><span class="line">\<span class="comment">#     gitlab-ctl  stop</span></span><br><span class="line"></span><br><span class="line">\<span class="comment"># gitlab-ctl  restar</span></span><br></pre></td></tr></table></figure>
<p><img src="img/5C1552472104713.png" alt="1552472104713"></p>
<h4 id="2-1-3-3：验证gitlab启动完成："><a href="#2-1-3-3：验证gitlab启动完成：" class="headerlink" title="2.1.3.3：验证gitlab启动完成："></a>2.1.3.3：验证gitlab启动完成：</h4><p>   <img src="img/5C1552472112782.png" alt="1552472112782"></p>
<h4 id="2-1-3-4：验证端口及状态："><a href="#2-1-3-4：验证端口及状态：" class="headerlink" title="2.1.3.4：验证端口及状态："></a>2.1.3.4：验证端口及状态：</h4><p>80端口是在初始化gitlib的时候启动的，因此如果之前的有程序占用会导致初始</p>
<p>化失败或无法访问！</p>
<p>lsof -i:80</p>
<p> <img src="img\5C1552472121857.png" alt="1552472121857"></p>
<h4 id="2-1-3-5：登录gitlab-web界面："><a href="#2-1-3-5：登录gitlab-web界面：" class="headerlink" title="2.1.3.5：登录gitlab web界面："></a>2.1.3.5：登录gitlab web界面：</h4><p><a href="http://192.168.245.17/">http://192.168.245.17/</a></p>
<p>登录web页面并设置密码,最少8位：</p>
<p>   <img src="img/5C1552472136817.png" alt="1552472136817"></p>
<h4 id="2-1-3-6：登录gitlab："><a href="#2-1-3-6：登录gitlab：" class="headerlink" title="2.1.3.6：登录gitlab："></a>2.1.3.6：登录gitlab：</h4><p>登录，默认用户为root：</p>
<p> <img src="img/5C1552472153118.png" alt="1552472153118"></p>
<h4 id="2-1-3-7：默认首页："><a href="#2-1-3-7：默认首页：" class="headerlink" title="2.1.3.7：默认首页："></a>2.1.3.7：默认首页：</h4><p> <img src="img/5C1552472164158.png" alt="1552472164158"></p>
<h4 id="2-1-3-8：关闭账号注册："><a href="#2-1-3-8：关闭账号注册：" class="headerlink" title="2.1.3.8：关闭账号注册："></a>2.1.3.8：关闭账号注册：</h4><p>默认情况下可以直接注册账号，因此一般都关闭次功能：</p>
<p> <img src="img/5C1552472174867.png" alt="1552472174867"></p>
<p>取消账户注册功能之后点save</p>
<p>   <img src="img/5C1552472184685.png" alt="1552472184685"></p>
<h4 id="2-1-3-9：验证是否还有注册选项："><a href="#2-1-3-9：验证是否还有注册选项：" class="headerlink" title="2.1.3.9：验证是否还有注册选项："></a>2.1.3.9：验证是否还有注册选项：</h4><p>   <img src="img/5C1552472194997.png" alt="1552472194997"></p>
<h4 id="2-1-3-10：创建git账户："><a href="#2-1-3-10：创建git账户：" class="headerlink" title="2.1.3.10：创建git账户："></a>2.1.3.10：创建git账户：</h4><p> <img src="img/5C1552472207852.png" alt="1552472207852"></p>
<h4 id="2-1-3-11：重新设置密码："><a href="#2-1-3-11：重新设置密码：" class="headerlink" title="2.1.3.11：重新设置密码："></a>2.1.3.11：重新设置密码：</h4><p>使用第一次使用新账号登录要设置密码：</p>
<p>​     </p>
<p> <img src="img/5C1552472215518.png" alt="1552472215518"></p>
<p>通过邮件重置用户密码：</p>
<p>   <img src="img/5C1552472226651.png" alt="1552472226651"></p>
<p>在收件箱打开邮件设置密码：</p>
<p>   <img src="img/5C1552472238523.png" alt="1552472238523"></p>
<p>​<br> 设置密码：</p>
<p>   <img src="img/5C1552472247536.png" alt="1552472247536"></p>
<p><img src="img/5C1552472273557.png" alt="1552472273557"></p>
<p>或者管理员创建账号时指定密码</p>
<h4 id="2-1-3-12：创建组："><a href="#2-1-3-12：创建组：" class="headerlink" title="2.1.3.12：创建组："></a>2.1.3.12：创建组：</h4><p>使用管理员root创建组，一个组里面可以有多个项目分支，可以将开发添加到组里面进行设置权限，不同的组就是公司不同的开发项目或者服务模块，不同的组添加不同的开发即可实现对开发设置权限的管理。</p>
<p> <img src="img/5C1552472288402.png" alt="1552472288402"></p>
<h4 id="2-1-3-13：使用管理员创建项目："><a href="#2-1-3-13：使用管理员创建项目：" class="headerlink" title="2.1.3.13：使用管理员创建项目："></a>2.1.3.13：使用管理员创建项目：</h4><p>   <img src="img/5C1552472296901.png" alt="1552472296901"></p>
<p>使用管理员创建项目：</p>
<p>   <img src="img/5C1552472307531.png" alt="1552472307531"></p>
<p>创建后的项目效果：</p>
<p>   <img src="img/5C1552472318834.png" alt="1552472318834"></p>
<h4 id="2-1-3-14：将用户添加到组："><a href="#2-1-3-14：将用户添加到组：" class="headerlink" title="2.1.3.14：将用户添加到组："></a>2.1.3.14：将用户添加到组：</h4><p><a href="https://docs.gitlab.com/ee/user/permissions.html">https://docs.gitlab.com/ee/user/permissions.html</a>  (更多权限)</p>
<p> <img src="img/5C1552472328177.png" alt="1552472328177"></p>
<p>2.1.3.15：创建一个测试页</p>
<p>   <img src="img/5C1552472346885.png" alt="1552472346885"></p>
<p>添加一个页面：</p>
<p>   <img src="img/5C1552472360149.png" alt="1552472360149"></p>
<p> <img src="img/5C1552472367128.png" alt="1552472367128"></p>
<h4 id="2-1-3-15：git客户端测试clone项目："><a href="#2-1-3-15：git客户端测试clone项目：" class="headerlink" title="2.1.3.15：git客户端测试clone项目："></a>2.1.3.15：git客户端测试clone项目：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@gitlab ~]<span class="comment">#git clone http://192.168.245.17/test-service/test-project.git</span></span><br><span class="line"></span><br><span class="line">Cloning into <span class="string">'test-project'</span>...</span><br><span class="line"></span><br><span class="line">Username <span class="keyword">for</span> <span class="string">'http://192.168.245.17'</span>: luhao</span><br><span class="line"></span><br><span class="line">Password <span class="keyword">for</span> <span class="string">'http://luhao@192.168.245.17'</span>: </span><br><span class="line"></span><br><span class="line">remote: Enumerating objects: 3, <span class="keyword">done</span>.</span><br><span class="line"></span><br><span class="line">remote: Counting objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line"></span><br><span class="line">remote: Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line"></span><br><span class="line">Unpacking objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line"></span><br><span class="line">[root@gitlab ~]<span class="comment">#cat test-project/index.html</span></span><br></pre></td></tr></table></figure>
<p>编辑文件并测试提交：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@gitlab ~]<span class="comment">#cd test-project/`</span></span><br></pre></td></tr></table></figure>
<p>[root@gitlab test-project]#git config –global user.name “luhao”</p>
<p>[root@gitlab test-project]#git config –global user.email <a href="mailto:htluhao@163.com">htluhao@163.com</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">[root@gitlab test-project]#vim index.html </span><br><span class="line"></span><br><span class="line">&lt;h1&gt;123432432411&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;123432432411&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;123432432411&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;123432432411&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;123432432411&lt;/h1&gt;</span><br></pre></td></tr></table></figure></p>
<p>[root@gitlab test-project]#git add index.html </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@gitlab <span class="built_in">test</span>-project]<span class="comment">#git commit -m "v1"</span></span><br><span class="line"></span><br><span class="line">[master 5ccda6e] v1</span><br><span class="line"></span><br><span class="line"> 1 file changed, 5 insertions(+), 1 deletion(-)`</span><br></pre></td></tr></table></figure>
<p>   <img src="img/5C1552472522711.png" alt="1552472522711"></p>
<h4 id="2-1-3-16-git-web端验证数据："><a href="#2-1-3-16-git-web端验证数据：" class="headerlink" title="2.1.3.16:git web端验证数据："></a>2.1.3.16:git web端验证数据：</h4><p><img src="img/5C1552472512837.png" alt="1552472512837"></p>
<h4 id="2-1-3-17：git常用命令："><a href="#2-1-3-17：git常用命令：" class="headerlink" title="2.1.3.17：git常用命令："></a>2.1.3.17：git常用命令：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name “name“ <span class="comment">#设置全局用户名</span></span><br><span class="line">git config --global user.email [xxx@xx.com ](mailto:xxx@xx.com)<span class="comment">#设置全局邮箱</span></span><br><span class="line">git config --global –list <span class="comment">#列出用户全局设置</span></span><br><span class="line">git add index.html / . <span class="comment">#添加指定文件、目录或当前目录下所有数据到暂存区</span></span><br><span class="line">git commit -m “11“ <span class="comment">#提交文件到工作区</span></span><br><span class="line">git status <span class="comment">#查看工作区的状态</span></span><br><span class="line">git push <span class="comment">#提交代码到服务器</span></span><br><span class="line">git pull <span class="comment">#获取代码到本地</span></span><br><span class="line">git <span class="built_in">log</span> <span class="comment">#查看操作日志</span></span><br><span class="line">vim .gitignore <span class="comment">#定义忽略文件</span></span><br><span class="line">git reset --hard HEAD^^ <span class="comment">#git版本回滚， HEAD为当前版本，加一个^为上一个，^^为上上一个版本</span></span><br><span class="line">git reflog <span class="comment"># #获取每次提交的ID，可以使用--hard根据提交的ID进行版本回退</span></span><br><span class="line">git reset --hard 5ae4b06 <span class="comment">#回退到指定id的版本</span></span><br><span class="line">git branch <span class="comment">#查看当前所处的分支</span></span><br><span class="line">git checkout  -b develop <span class="comment">#创建并切换到一个新分支</span></span><br><span class="line">git checkout   develop <span class="comment">#切换分支</span></span><br></pre></td></tr></table></figure>
<h1 id="三：部署web服务器环境："><a href="#三：部署web服务器环境：" class="headerlink" title="三：部署web服务器环境："></a>三：部署web服务器环境：</h1><h4 id="3-1-部署tomcat环境"><a href="#3-1-部署tomcat环境" class="headerlink" title="3.1  部署tomcat环境"></a>3.1  部署tomcat环境</h4><p>各wenb服务器准备tomcat运行环境：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@tomcat-web1 /]<span class="comment"># useradd www -u 2000</span></span><br><span class="line">[root@tomcat-web1 /]<span class="comment">#  mkdir /apps &amp;&amp; cd /apps</span></span><br><span class="line">[root@tomcat-web1 apps]<span class="comment"># tar xvf jdk-8u192-linux-x64.tar.gz </span></span><br><span class="line">[root@tomcat-web1 /]<span class="comment">#  ln -sv /apps/jdk1.8.0_192/ /apps/jdk</span></span><br><span class="line">[root@tomcat-web1 /]<span class="comment">#  vim /etc/profile</span></span><br><span class="line"><span class="built_in">export</span> HISTTIMEFORMAT=<span class="string">"%F %T whoami "</span></span><br><span class="line"><span class="built_in">export</span> <span class="built_in">export</span> LANG=<span class="string">"en_US.utf-8"</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/apps/jdk</span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/jre/lib/rt.jar:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br><span class="line"></span><br><span class="line">[root@tomcat-web1 apps]<span class="comment"># ln -sv /apps/jdk1.8.0_192/ /apps/jdk</span></span><br><span class="line">‘/apps/jdk’ -&gt; ‘/apps/jdk1.8.0_192/’</span><br><span class="line">[root@tomcat-web1 apps]<span class="comment"># source /etc/profile</span></span><br><span class="line">[root@tomcat-web1 apps]<span class="comment"># java -version</span></span><br><span class="line"></span><br><span class="line">java version <span class="string">"1.8.0_192"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_192-b12)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.192-b12, mixed mode)</span><br><span class="line">\<span class="comment"># tar xvf  apache-tomcat-8.5.37.tar.gz</span></span><br><span class="line">\<span class="comment"># ln -sv /apps/apache-tomcat-8.5.37 /apps/tomcat</span></span><br><span class="line">[root@tomcat-web2 apps]<span class="comment"># mkdir /data/tomcat_webdir /data/tomcat_appdir -pv</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim /apps/apache-tomcat-8.5.37/conf/server.xml</span><br><span class="line">#配置tomcat配置文件：</span><br><span class="line">appBase=&quot;/data/tomcat_webdir/&quot;    unpackWARs=&quot;false&quot; autoDeploy=&quot;false&quot;</span><br><span class="line">cd /data/tomcat_webdir/</span><br><span class="line">mkdir myapp</span><br><span class="line">vim myapp/index.html</span><br><span class="line">写入</span><br><span class="line">[root@tomcat-web1 ~]# cat /data/tomcat_webdir/myapp/index.html</span><br></pre></td></tr></table></figure>
<p>&lt;!DOCTYPE html&gt;</p>
<html lang="en"><br><head><meta name="generator" content="Hexo 3.8.0"><br>        <title>dsadasd</title><br></head><br><body><br><h1>tomcat1</h1><br><h1></h1><br></body><br></html>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cp /apps/tomcat/webapps/* /data/tomcat_webdir/ -r -a</span><br><span class="line">rz上传脚本 tomcat</span><br><span class="line">cp /root/tomcat /etc/init.d/</span><br><span class="line">chmod a+x /etc/init.d/tomcat </span><br><span class="line">useradd tomcat -u 2001</span><br><span class="line">passwd tomcat</span><br><span class="line">su - tomcat</span><br><span class="line">/etc/init.d/tomcat start</span><br></pre></td></tr></table></figure>
<p><img src="img/5C1552635507551.png" alt="1552635507551"></p>
<p>打开172.20.102.228:8080/myapp/确认各web服务器访问正常：</p>
<p> <img src="img/5C1552548720334.png" alt="1552548720334"></p>
<p>​<br> <img src="img/5C1552548757681.png" alt="1552548757681"></p>
<h4 id="3-2-部署keepalived"><a href="#3-2-部署keepalived" class="headerlink" title="3.2 部署keepalived"></a>3.2 部署keepalived</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum install libnfnetlink-devel libnfnetlink ipvsadm libnl libnl-devel libnl3 libnl3-devel lm_sensors-libs net-snmp-agent-libs net-snmp-libs open server openssh-clients openssl openssl-devel automake iproute</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#编译安装</span></span><br><span class="line">\<span class="comment"># cd keepalived-2.0.7 &amp;&amp; ./configure --prefix=/usr/local/keepalived --disable-fwmark</span></span><br><span class="line">\<span class="comment"># make &amp;&amp; amke install</span></span><br><span class="line">\<span class="comment"># # mkdir /usr/local/keepalived/etc/sysconfig –p &amp;&amp; cp keepalived/etc/init.d/keepalived.rh.init /usr/local/keepalived/etc/sysconfig/keepalived</span></span><br><span class="line">\<span class="comment"># cp keepalived/keepalived.service /usr/lib/systemd/system/</span></span><br><span class="line">\<span class="comment"># mkdir /usr/local/keepalived/sbin &amp;&amp; cp bin/keepalived /usr/local/keepalived/sbin/keepalived</span></span><br><span class="line">\<span class="comment"># mkdir /etc/keepalived</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#本次采用yum安装</span></span><br><span class="line">yum install keepalived -y</span><br><span class="line"></span><br><span class="line">haproxy1 上的keepalived为MASTER</span><br><span class="line">haproxy2 上的keepalived为BACKUP</span><br><span class="line">地址都为172.20.102.248</span><br><span class="line">做keepalived高可用，使用ifconfig可是两个keepalived存活性是否生效两台只允许有一个eth0:1，停掉一台，另一台开始服务</span><br><span class="line"></span><br><span class="line">\<span class="comment"># vim /etc/keepalived/keepalived.conf</span></span><br><span class="line"></span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 90</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 1111</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        172.20.102.248 dev eth0 label eth0:1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@haproxy2 ~]<span class="comment"># systemctl restart keepalived</span></span><br><span class="line">[root@haproxy2 ~]<span class="comment"># systemctl enable keepalived</span></span><br></pre></td></tr></table></figure>
<p> haproxy2<img src="img/5C1552628612457.png" alt="1552628612457"></p>
<h4 id="3-3部署haproxy："><a href="#3-3部署haproxy：" class="headerlink" title="3.3部署haproxy："></a>3.3部署haproxy：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">#编译安装</span><br><span class="line"># tar xvf haproxy-1.8.13.tar.gz</span><br><span class="line"># cd haproxy-1.8.13</span><br><span class="line"># make ARCH=x86_64 TARGET=linux2628 USE_PCRE=1 USE_OPENSSL=1 USE_ZLIB=1 USE_SYSTEMD=1 USE_CPU_AFFINITY=1 PREFIX=/usr/local/haproxy</span><br><span class="line"># make install PREFIX=/usr/local/haproxy</span><br><span class="line"># vim /usr/lib/systemd/system/haproxy.service</span><br><span class="line">[Unit]</span><br><span class="line">Description=HAProxy Load Balancer</span><br><span class="line">After=syslog.target network.target</span><br><span class="line">[Service]</span><br><span class="line">#支持多配置文件读取，类似于从侧面是实现配置文件的include功能。</span><br><span class="line">ExecStartPre=/usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -f /etc/haproxy/conf -c -q</span><br><span class="line">ExecStart=/usr/sbin/haproxy -Ws -f /etc/haproxy/haproxy.cfg -f /etc/haproxy/conf -p /run/haproxy.pid</span><br><span class="line">ExecReload=/bin/kill -USR2 $MAINPID</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line"># mkdir /etc/haproxy</span><br><span class="line">本次采用yum 安装</span><br><span class="line">yum install haproxy -y</span><br><span class="line">vim /etc/haproxy/haproxy.cfg</span><br><span class="line"></span><br><span class="line">global</span><br><span class="line">    # to have these messages end up in /var/log/haproxy.log you will</span><br><span class="line">    # need to:</span><br><span class="line">    #</span><br><span class="line">    # 1) configure syslog to accept network log events.  This is done</span><br><span class="line">    #    by adding the &apos;-r&apos; option to the SYSLOGD_OPTIONS in</span><br><span class="line">    #    /etc/sysconfig/syslog</span><br><span class="line">    #</span><br><span class="line">    # 2) configure local2 events to go to the /var/log/haproxy.log</span><br><span class="line">    #   file. A line like the following can be added to</span><br><span class="line">    #   /etc/sysconfig/syslog</span><br><span class="line">    #</span><br><span class="line">    #    local2.*                       /var/log/haproxy.log</span><br><span class="line">    #</span><br><span class="line">    log         127.0.0.1 local2</span><br><span class="line"></span><br><span class="line">    chroot      /var/lib/haproxy</span><br><span class="line">    pidfile     /var/run/haproxy.pid</span><br><span class="line">    maxconn     4000</span><br><span class="line">    user        haproxy</span><br><span class="line">    group       haproxy</span><br><span class="line">    daemon</span><br><span class="line"></span><br><span class="line">    # turn on stats unix socket</span><br><span class="line">    stats socket /var/lib/haproxy/stats</span><br><span class="line"></span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line"># common defaults that all the &apos;listen&apos; and &apos;backend&apos; sections will</span><br><span class="line"># use if not designated in their block</span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line">defaults</span><br><span class="line">    mode                    http</span><br><span class="line">    log                     global</span><br><span class="line">    option                  httplog</span><br><span class="line">    option                  dontlognull</span><br><span class="line">    option http-server-close</span><br><span class="line">    option forwardfor       except 127.0.0.0/8</span><br><span class="line">    option                  redispatch</span><br><span class="line">    retries                 3</span><br><span class="line">    timeout http-request    10s</span><br><span class="line">    timeout queue           1m</span><br><span class="line">    timeout connect         10s</span><br><span class="line">    timeout client          1m</span><br><span class="line">    timeout server          1m</span><br><span class="line">    timeout http-keep-alive 10s</span><br><span class="line">    timeout check           10s</span><br><span class="line">    maxconn                 3000</span><br><span class="line"></span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line"># main frontend which proxys to the backends</span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line">#此处需要app或者官网访问入口</span><br><span class="line">listen myapp</span><br><span class="line">    bind 172.20.102.248：80</span><br><span class="line">    balance     roundrobin</span><br><span class="line">    server  172.20.102.228 172.20.102.228:8080 check</span><br><span class="line">    server  172.20.102.216 172.20.102.240:8080 check </span><br><span class="line">    </span><br><span class="line">[root@haproxy2 ~]# systemctl restart haproxy</span><br><span class="line">[root@haproxy2 ~]# systemctl enable haproxy</span><br></pre></td></tr></table></figure>
<p><img src="img/5C1552625864421.png" alt="1552625864421"></p>
<p>注释：</p>
<p>1 gitlab-server      172.20.102.205<br>2 jenkins-server   172.20.102.222<br>3 tomcat-web1      172.20.102.228<br>4 tomcat-web2      172.20.102.240<br>5 haproxy1             172.20.102.216<br>6 haproxy2             172.20.102.253 </p>
<h4 id="3-3-1-测试haproxy反向代理web服务器："><a href="#3-3-1-测试haproxy反向代理web服务器：" class="headerlink" title="3.3.1: 测试haproxy反向代理web服务器："></a>3.3.1: 测试haproxy反向代理web服务器：</h4><p>编辑本机hosts文件，将myapp.web.com解析到对应的IP负载IP：</p>
<p>C:\Windows\System32\drivers\etc\hosts</p>
<p>172.20.102.101 myapp.web.com</p>
<h4 id="3-3-2-记录HAProxy访问日志："><a href="#3-3-2-记录HAProxy访问日志：" class="headerlink" title="3.3.2: 记录HAProxy访问日志："></a>3.3.2: 记录HAProxy访问日志：</h4><p># vim /etc/rsyslog.conf：</p>
<p>14 # Provides UDP syslog reception</p>
<p>15 $ModLoad imudp #去掉注释</p>
<p>16 $UDPServerRun 514 #去掉注释</p>
<p>18 # Provides TCP syslog reception</p>
<p>19 $ModLoad imtcp #去掉注释</p>
<p>20 $InputTCPServerRun 514 #去掉注释</p>
<p>93 local3.* /var/log/haproxy.log</p>
<p># systemctl restart rsyslog</p>
<p>log 127.0.0.1 local3 info #global部分</p>
<p>listen web_port</p>
<p>bind 0.0.0.0:80</p>
<p>mode http</p>
<p>log global</p>
<p>option httplog</p>
<p>server 192.168.7.103 192.168.7.103:8080 check inter 3000 fall 2 rise 5</p>
<p>server 192.168.7.104 192.168.7.104:8080 check inter 3000 fall 2 rise 5</p>
<p>​<br> 重启rsyslog和haproxy服务，验证/var/log/haproxy.log可以记录日志：</p>
<h4 id="3-3-3-验证HAProxy统计页面："><a href="#3-3-3-验证HAProxy统计页面：" class="headerlink" title="3.3.3: 验证HAProxy统计页面："></a>3.3.3: 验证HAProxy统计页面：</h4><p><a href="http://myapp.web.com:9009/haproxy-status">http://myapp.web.com:9009/haproxy-status</a></p>
<p>​        </p>
<h4 id="3-3-4-验证haproxy代理web服务器："><a href="#3-3-4-验证haproxy代理web服务器：" class="headerlink" title="3.3.4.: 验证haproxy代理web服务器："></a>3.3.4.: 验证haproxy代理web服务器：</h4><p><a href="http://myapp.web.com/myapp/">http://myapp.web.com/myapp/</a></p>
<h1 id="四：Jenkins部署与基础配置："><a href="#四：Jenkins部署与基础配置：" class="headerlink" title="四：Jenkins部署与基础配置："></a>四：Jenkins部署与基础配置：</h1><h2 id="4-1：配置java环境并部署jenkins："><a href="#4-1：配置java环境并部署jenkins：" class="headerlink" title="4.1：配置java环境并部署jenkins："></a>4.1：配置java环境并部署jenkins：</h2><h3 id="4-1-1：java环境配置："><a href="#4-1-1：java环境配置：" class="headerlink" title="4.1.1：java环境配置："></a>4.1.1：java环境配置：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost src]# tar xvf jdk-8u192-linux-x64.tar.gz</span><br><span class="line"></span><br><span class="line">[root@localhost src]#ln -sv /usr/local/src/jdk1.8.0_192/ /usr/local/jdk</span><br><span class="line"></span><br><span class="line">[root@localhost src]# vim /etc/profile</span><br><span class="line"></span><br><span class="line">export JAVA_HOME=/usr/local/jdk</span><br><span class="line"></span><br><span class="line">export PATH=$JAVA_HOME/bin:$JAVA_HOME/jre/bin:$PATH</span><br><span class="line"></span><br><span class="line">export CLASSPATH=.$CLASSPATH:$JAVA_HOME/lib:$JAVA_HOME/jre/lib:$JAVA_HOME/lib/tools.jar</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">[root@localhost src]#source /etc/profile</span><br><span class="line"></span><br><span class="line">[root@localhost src]#java -version</span><br><span class="line"></span><br><span class="line">java version &quot;1.8.0_192&quot;</span><br><span class="line"></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_192-b12)</span><br><span class="line"></span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.192-b12, mixed mode)</span><br></pre></td></tr></table></figure>
<h3 id="4-1-2：启动Jenkins"><a href="#4-1-2：启动Jenkins" class="headerlink" title="4.1.2：启动Jenkins"></a>4.1.2：启动Jenkins</h3><h4 id="4-1-2-1：通过jar包直接启动jenkins："><a href="#4-1-2-1：通过jar包直接启动jenkins：" class="headerlink" title="4.1.2.1：通过jar包直接启动jenkins："></a>4.1.2.1：通过jar包直接启动jenkins：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># java \</span><br><span class="line"></span><br><span class="line">-Dcom.sun.management.jmxremote \</span><br><span class="line"></span><br><span class="line">-Dcom.sun.management.jmxremote.port=12345 \</span><br><span class="line"></span><br><span class="line">-Dcom.sun.management.jmxremote.authenticate=false \</span><br><span class="line"></span><br><span class="line">-Dcom.sun.management.jmxremote.ssl=false \</span><br><span class="line"></span><br><span class="line">-Djava.rmi.server.hostname=&quot;192.168.245.27  &quot; \</span><br><span class="line"></span><br><span class="line">-jar jenkins-2.138.3.war &amp;</span><br><span class="line"></span><br><span class="line">此方法失败了，所以通过安装rpm包安装了</span><br></pre></td></tr></table></figure>
<h4 id="4-1-2-2：rpm包安装jenkins配置："><a href="#4-1-2-2：rpm包安装jenkins配置：" class="headerlink" title="4.1.2.2：rpm包安装jenkins配置："></a>4.1.2.2：rpm包安装jenkins配置：</h4><p>rz<br>rpm -ivh jenkins-2.138.3-1.1.noarch.rpm<br>grep -v “#” /etc/sysconfig/jenkins  | grep -v “^$”<br>vim /etc/sysconfig/jenkins </p>
<p>JENKINS_HOME=”/var/lib/jenkins”<br>JENKINS_JAVA_CMD=””<br>JENKINS_USER=”jenkins”<br>JENKINS_JAVA_OPTIONS=”-Djava.awt.headless=true”<br>JENKINS_PORT=”8080”<br>JENKINS_LISTEN_ADDRESS=””<br>JENKINS_HTTPS_PORT=””<br>JENKINS_HTTPS_KEYSTORE=””<br>JENKINS_HTTPS_KEYSTORE_PASSWORD=””<br>JENKINS_HTTPS_LISTEN_ADDRESS=””<br>JENKINS_DEBUG_LEVEL=”5”<br>JENKINS_ENABLE_ACCESS_LOG=”no”<br>JENKINS_HANDLER_MAX=”100”<br>JENKINS_HANDLER_IDLE=”20”<br>JENKINS_ARGS=””</p>
<p>systemctl restart jenkins</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@s1 ~]<span class="comment"># grep -v "#" /etc/sysconfig/jenkins  | grep -v "^$"</span></span><br><span class="line"></span><br><span class="line">JENKINS_HOME=<span class="string">"/var/lib/jenkins"</span></span><br><span class="line">JENKINS_JAVA_CMD=<span class="string">""</span></span><br><span class="line">JENKINS_USER=<span class="string">"root"</span></span><br><span class="line">JENKINS_JAVA_OPTIONS=<span class="string">"-Djava.awt.headless=true \</span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote \</span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote.port=12345 \</span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote.authenticate=false \</span></span><br><span class="line"><span class="string">-Dcom.sun.management.jmxremote.ssl=false \</span></span><br><span class="line"><span class="string">-Djava.rmi.server.hostname="</span>192.168.245.27<span class="string">" </span></span><br><span class="line"><span class="string">"</span></span><br><span class="line">JENKINS_PORT=<span class="string">"8080"</span></span><br><span class="line">JENKINS_LISTEN_ADDRESS=<span class="string">""</span></span><br><span class="line">JENKINS_HTTPS_PORT=<span class="string">""</span></span><br><span class="line">JENKINS_HTTPS_KEYSTORE=<span class="string">""</span></span><br><span class="line">JENKINS_HTTPS_KEYSTORE_PASSWORD=<span class="string">""</span></span><br><span class="line">JENKINS_HTTPS_LISTEN_ADDRESS=<span class="string">""</span></span><br><span class="line">JENKINS_DEBUG_LEVEL=<span class="string">"5"</span></span><br><span class="line">JENKINS_ENABLE_ACCESS_LOG=<span class="string">"no"</span></span><br><span class="line">JENKINS_HANDLER_MAX=<span class="string">"100"</span></span><br><span class="line">JENKINS_HANDLER_IDLE=<span class="string">"20"</span></span><br><span class="line">JENKINS_ARGS=<span class="string">""</span></span><br></pre></td></tr></table></figure>
<h3 id="4-1-3-Jenkins-启动过程："><a href="#4-1-3-Jenkins-启动过程：" class="headerlink" title="4.1.3:Jenkins 启动过程："></a>4.1.3:Jenkins 启动过程：</h3><p>​                                          <img src="img/5C1552642826794.png" alt="1552642826794">        </p>
<h3 id="4-1-4：访问jenkins-页面"><a href="#4-1-4：访问jenkins-页面" class="headerlink" title="4.1.4：访问jenkins 页面"></a>4.1.4：访问jenkins 页面</h3><p> <img src="img/5C1552642838623.png" alt="1552642838623"></p>
<h3 id="4-1-5：选择安装jenkins插件："><a href="#4-1-5：选择安装jenkins插件：" class="headerlink" title="4.1.5：选择安装jenkins插件："></a>4.1.5：选择安装jenkins插件：</h3><p>​        </p>
<p> <img src="img/5C1552642848919.png" alt="1552642848919"></p>
<h3 id="4-1-6：插件安装过程中："><a href="#4-1-6：插件安装过程中：" class="headerlink" title="4.1.6：插件安装过程中："></a>4.1.6：插件安装过程中：</h3><p>插件安装过程中。。，如果因为某种原因导致有有安装失败的插件，没有关系，可以后期再单独安装</p>
<p> <img src="img/5C1552642861246.png" alt="1552642861246"></p>
<h3 id="4-1-7：创建jenkins管理员："><a href="#4-1-7：创建jenkins管理员：" class="headerlink" title="4.1.7：创建jenkins管理员："></a>4.1.7：创建jenkins管理员：</h3><p> <img src="img/5C1552642970678.png" alt="1552642970678"></p>
<h3 id="4-1-8：配置jenkins-URL："><a href="#4-1-8：配置jenkins-URL：" class="headerlink" title="4.1.8：配置jenkins URL："></a>4.1.8：配置jenkins URL：</h3><p> <img src="img/1552642902559.png" alt="1552642902559"></p>
<h3 id="4-1-9：配置完成并登陆jenkins："><a href="#4-1-9：配置完成并登陆jenkins：" class="headerlink" title="4.1.9：配置完成并登陆jenkins："></a>4.1.9：配置完成并登陆jenkins：</h3><p> <img src="img/5C1552642983156.png" alt="1552642983156"></p>
<p> <img src="img/5C1552642990899.png" alt="1552642990899"></p>
<h3 id="4-1-10：登陆jenkins界面："><a href="#4-1-10：登陆jenkins界面：" class="headerlink" title="4.1.10：登陆jenkins界面："></a>4.1.10：登陆jenkins界面：</h3><p>   <img src="img/5C1552643006981.png" alt="1552643006981"></p>
<h3 id="4-1-11：jenkins插件管理及安装："><a href="#4-1-11：jenkins插件管理及安装：" class="headerlink" title="4.1.11：jenkins插件管理及安装："></a>4.1.11：jenkins插件管理及安装：</h3><h4 id="4-1-11-1：插件安装目录："><a href="#4-1-11-1：插件安装目录：" class="headerlink" title="4.1.11.1：插件安装目录："></a>4.1.11.1：插件安装目录：</h4><p>插件下载地址：<a href="http://updates.jenkins-ci.org/download/plugins/">http://updates.jenkins-ci.org/download/plugins/</a></p>
<p> <img src="img/5C1552643017898.png" alt="1552643017898"></p>
<h4 id="4-1-11-2：安装插件："><a href="#4-1-11-2：安装插件：" class="headerlink" title="4.1.11.2：安装插件："></a>4.1.11.2：安装插件：</h4><p>搜索需要gitlab的插件并安装：</p>
<p>gitlab和Blue Ocean</p>
<p>   <img src="img/5C1552643030371.png" alt="1552643030371"></p>
<p> <img src="img/5C1552643037904.png" alt="1552643037904"></p>
<p> <img src="img/5C1552643054619.png" alt="1552643054619"></p>
<h3 id="4-1-12：配置jenkins-权限管理："><a href="#4-1-12：配置jenkins-权限管理：" class="headerlink" title="4.1.12：配置jenkins 权限管理："></a>4.1.12：配置jenkins 权限管理：</h3><p>基于角色的权限管理，先创建角色和用户，给角色授权，然后把用户管理到角色。</p>
<h4 id="4-1-12-1：安装插件："><a href="#4-1-12-1：安装插件：" class="headerlink" title="4.1.12.1：安装插件："></a>4.1.12.1：安装插件：</h4><p> Role-based <img src="img/5C1552643075784.png" alt="1552643075784"></p>
<h4 id="4-1-12-2：创建新用户："><a href="#4-1-12-2：创建新用户：" class="headerlink" title="4.1.12.2：创建新用户："></a>4.1.12.2：创建新用户：</h4><p>Jenkins—系统管理—管理用户：</p>
<p> <img src="img/5C1552643101167.png" alt="1552643101167"></p>
<h4 id="4-1-12-3：更改认证方式："><a href="#4-1-12-3：更改认证方式：" class="headerlink" title="4.1.12.3：更改认证方式："></a>4.1.12.3：更改认证方式：</h4><p>Jenkins—系统管理—全局安全配置</p>
<p>默认创建的用户登录后可以做任何操作，取决于默认的认证授权方式。</p>
<p><img src="img/5C1552643120269.png" alt="1552643120269"></p>
<p>  设置角色认证后，<strong>在进行角色授权之后才能退出浏览器，否则会导致账号登陆不上</strong><img src="img/5C1552648275024.png" alt="1552648275024"></p>
<h4 id="4-1-12-4：创建角色："><a href="#4-1-12-4：创建角色：" class="headerlink" title="4.1.12.4：创建角色："></a>4.1.12.4：创建角色：</h4><p>Jenkins—系统管理–Manage and Assign Roles</p>
<p><img src="img/5C1552647914080.png" alt="1552647914080"></p>
<h4 id="4-1-12-5：添加规则组："><a href="#4-1-12-5：添加规则组：" class="headerlink" title="4.1.12.5：添加规则组："></a>4.1.12.5：添加规则组：</h4><p>   <img src="img/5C1552643144924.png" alt="1552643144924"></p>
<h4 id="4-1-12-6：对组分配权限："><a href="#4-1-12-6：对组分配权限：" class="headerlink" title="4.1.12.6：对组分配权限："></a>4.1.12.6：对组分配权限：</h4><p>   <img src="img/5C1552643154495.png" alt="1552643154495"></p>
<h4 id="4-1-12-7：将用户关联到规则组："><a href="#4-1-12-7：将用户关联到规则组：" class="headerlink" title="4.1.12.7：将用户关联到规则组："></a>4.1.12.7：将用户关联到规则组：</h4><p><img src="img/5C1552648051153.png" alt="1552648051153"></p>
<h4 id="4-1-12-8：测试普通用户登录："><a href="#4-1-12-8：测试普通用户登录：" class="headerlink" title="4.1.12.8：测试普通用户登录："></a>4.1.12.8：测试普通用户登录：</h4><p><img src="img/5C1552648342809.png" alt="1552648342809"></p>
<p>登录成功之的界面，没有系统管理权限，只能执行被授权过的job且没有了管理员权限。</p>
<p> <img src="img/5C1552643193611.png" alt="1552643193611"></p>
<h3 id="4-1-13：jenkins-邮箱配置："><a href="#4-1-13：jenkins-邮箱配置：" class="headerlink" title="4.1.13：jenkins 邮箱配置："></a>4.1.13：jenkins 邮箱配置：</h3><h4 id="4-1-13-1：生成QQ邮箱登录授权码："><a href="#4-1-13-1：生成QQ邮箱登录授权码：" class="headerlink" title="4.1.13.1：生成QQ邮箱登录授权码："></a>4.1.13.1：生成QQ邮箱登录授权码：</h4><p>   <img src="img/5C1552643209319.png" alt="1552643209319"></p>
<h4 id="4-1-13-2：配置jenkins管理员邮箱："><a href="#4-1-13-2：配置jenkins管理员邮箱：" class="headerlink" title="4.1.13.2：配置jenkins管理员邮箱："></a>4.1.13.2：配置jenkins管理员邮箱：</h4><p>Jenkins—系统管理—系统设置：</p>
<p>   <img src="img/5C1552643219014.png" alt="1552643219014"></p>
<h4 id="4-1-13-3：发件配置："><a href="#4-1-13-3：发件配置：" class="headerlink" title="4.1.13.3：发件配置："></a>4.1.13.3：发件配置：</h4><p>   <img src="img/5C1552643230054.png" alt="1552643230054"></p>
<h4 id="4-1-13-4：测试发送邮件："><a href="#4-1-13-4：测试发送邮件：" class="headerlink" title="4.1.13.4：测试发送邮件："></a>4.1.13.4：测试发送邮件：</h4><p> <img src="img/5C1552643240019.png" alt="1552643240019"></p>
<h2 id="4-2：基于ssh-key拉取代码："><a href="#4-2：基于ssh-key拉取代码：" class="headerlink" title="4.2：基于ssh key拉取代码："></a>4.2：基于ssh key拉取代码：</h2><h3 id="4-2-1：添加ssh-key："><a href="#4-2-1：添加ssh-key：" class="headerlink" title="4.2.1：添加ssh key："></a>4.2.1：添加ssh key：</h3><p> <img src="img/5C1552643253854.png" alt="1552643253854"></p>
<p>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC3niuTNTXCA4zoltRTu+qDMOyF0xglYFxIIZMolCH2+Ma3L4v/D72WascVBD4LrkJM3S6KTSLn4M4+7l+9fe5LaZu0WSD2Se2N0FVcPFsYOK5ZwPoWiL83R5T2bN4j69G7cAtHM5X5WOAuJs6ArSBSxsSnyeFnUFNw3rbmkCCt2TvrsmqTzEMA1PDQno/7wB3n8JfxjaKp5oHNPQrwN0p0lGuUMSxGSNjCEIiexxqpyrJ0DPShs+XximSOO7noWbZq2nMhsH7yWdwKN3qD00U52ACDijeAyKVa4ByQntDIPeCr8gdUZiT8rbfXtix2MhR2cCgZJAKYDQNAwltVVOCf <a href="mailto:root@jenkins.example.com">root@jenkins.example.com</a></p>
<h3 id="4-2-2：添加ssh-key："><a href="#4-2-2：添加ssh-key：" class="headerlink" title="4.2.2：添加ssh key："></a>4.2.2：添加ssh key：</h3><p>   <img src="img/5C1552643289387.png" alt="1552643289387"></p>
<h3 id="4-2-3：创建ssh-key："><a href="#4-2-3：创建ssh-key：" class="headerlink" title="4.2.3：创建ssh key："></a>4.2.3：创建ssh key：</h3><p><strong>ssh key**</strong>只用于免认证获取代码**</p>
<p><strong>gitlab**</strong>和<strong><strong>jenkins</strong></strong>分别位于<strong> </strong>两个<strong> </strong>服务器**</p>
<p><strong>分别生成公钥私钥</strong></p>
<p><strong>ssh-keygen</strong> <strong>回车三次</strong></p>
<p><strong>cat /root/.ssh/id_rsa</strong></p>
<p><strong>cat /root/.ssh/id_rsa.pub</strong></p>
<p><strong>gitlab**</strong>网页添加<strong><strong>jenkins</strong></strong>服务器端生成的公钥<strong>**id_rsa.pub</strong></p>
<p><strong>jenkins**</strong>网页添加凭证要<strong><strong>jenkins</strong></strong>服务器端生成的私钥<strong>**id_rsa</strong></p>
<p>   <img src="img/5C1552643308322.png" alt="1552643308322"></p>
<h3 id="4-2-4：测试ssh-key："><a href="#4-2-4：测试ssh-key：" class="headerlink" title="4.2.4：测试ssh key："></a>4.2.4：测试ssh key：</h3><p>测试可以不使用用户名密码后直接获取代码</p>
<p> <img src="img/5C1552643338278.png" alt="1552643338278"></p>
<h2 id="4-3：配置jenkins自动拉取代码："><a href="#4-3：配置jenkins自动拉取代码：" class="headerlink" title="4.3：配置jenkins自动拉取代码："></a>4.3：配置jenkins自动拉取代码：</h2><h3 id="4-3-1：jenkins-服务器添加证书："><a href="#4-3-1：jenkins-服务器添加证书：" class="headerlink" title="4.3.1：jenkins 服务器添加证书："></a>4.3.1：jenkins 服务器添加证书：</h3><p>Jenkins-凭据-jenkins—全局凭据—添加凭据</p>
<p>   <img src="img/5C1552643352409.png" alt="1552643352409"></p>
<h3 id="4-3-2：jenkins创建project："><a href="#4-3-2：jenkins创建project：" class="headerlink" title="4.3.2：jenkins创建project："></a>4.3.2：jenkins创建project：</h3><p><img src="img/5C1552643361258.png" alt="1552643361258"></p>
<p>构建一个shell</p>
<p><img src="img/5C1552649610425.png" alt="1552649610425"> </p>
<h3 id="4-3-3：配置git项目地址和用户："><a href="#4-3-3：配置git项目地址和用户：" class="headerlink" title="4.3.3：配置git项目地址和用户："></a>4.3.3：配置git项目地址和用户：</h3><p>添加完成的证书没有报错表示认证通过</p>
<p> <img src="img/5C1552643372081.png" alt="1552643372081"></p>
<h3 id="4-3-4：测试构建项目："><a href="#4-3-4：测试构建项目：" class="headerlink" title="4.3.4：测试构建项目："></a>4.3.4：测试构建项目：</h3><h4 id="4-3-4-1：点击立即构建："><a href="#4-3-4-1：点击立即构建：" class="headerlink" title="4.3.4.1：点击立即构建："></a>4.3.4.1：点击立即构建：</h4><p> <img src="img/5C1552643383906.png" alt="1552643383906"></p>
<h4 id="4-3-4-2：验证构建结果："><a href="#4-3-4-2：验证构建结果：" class="headerlink" title="4.3.4.2：验证构建结果："></a>4.3.4.2：验证构建结果：</h4><p> <img src="img/5C1552643394758.png" alt="1552643394758"></p>
<h4 id="4-3-4-3：服务器验证数据："><a href="#4-3-4-3：服务器验证数据：" class="headerlink" title="4.3.4.3：服务器验证数据："></a>4.3.4.3：服务器验证数据：</h4><p> <img src="img/5C1552643405100.png" alt="1552643405100"></p>
<h4 id="4-3-4-4：将代码部署至后端服务器："><a href="#4-3-4-4：将代码部署至后端服务器：" class="headerlink" title="4.3.4.4：将代码部署至后端服务器："></a>4.3.4.4：将代码部署至后端服务器：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> jenkins服务器先对后端tomcat服务器做基于tomcat的免密钥登陆</span><br><span class="line">ssh-copy-id -i /root/.ssh/id_rsa.pub tomcat@172.20.102.228</span><br><span class="line">ssh-copy-id -i /root/.ssh/id_rsa.pub tomcat@172.20.102.240</span><br></pre></td></tr></table></figure>
<p>将下列脚本写到Jenkins的web端的代码构建中</p>
<p>脚本内容：</p>
<p>###<br>git clone -b master <a href="mailto:git@172.20.102.205">git@172.20.102.205</a>:myapp/test-project.git<br>cd /var/lib/jenkins/workspace/demo1/test-project/<br>ssh <a href="mailto:tomcat@172.20.102.228">tomcat@172.20.102.228</a> “/etc/init.d/tomcat stop”<br>ssh <a href="mailto:tomcat@172.20.102.240">tomcat@172.20.102.240</a> “/etc/init.d/tomcat stop”<br>scp index.html  <a href="mailto:tomcat@172.20.102.228">tomcat@172.20.102.228</a>:/data/tomcat_webdir/myapp/<br>scp index.html  <a href="mailto:tomcat@172.20.102.240">tomcat@172.20.102.240</a>:/data/tomcat_webdir/myapp/<br>ssh <a href="mailto:tomcat@172.20.102.228">tomcat@172.20.102.228</a> “/etc/init.d/tomcat start”<br>ssh <a href="mailto:tomcat@172.20.102.240">tomcat@172.20.102.240</a> “/etc/init.d/tomcat start”</p>
<p> 构建之前</p>
<p><img src="img/5C1552654945805.png" alt="1552654945805"></p>
<p>在gitlib上更新index.html文件并上传</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  255  2019-03-15 20:51:41 root vim index.html</span><br><span class="line">  256  2019-03-15 20:53:10 root git add index.html</span><br><span class="line">  257  2019-03-15 20:53:21 root git commit -m <span class="string">"v1"</span></span><br><span class="line">  258  2019-03-15 20:53:27 root git push</span><br><span class="line">  259  2019-03-15 20:54:01 root cat index.html </span><br><span class="line">  260  2019-03-15 20:54:53 root <span class="built_in">history</span> </span><br><span class="line">[root@gitlab-server <span class="built_in">test</span>-project]<span class="comment"># cat index.html</span></span><br></pre></td></tr></table></figure>
<p><img src="img/5C1552654519301.png" alt="1552654519301"></p>
<p>上传完成后点击立即构建</p>
<p><img src="img/5C1552654828341.png" alt="1552654828341"></p>
<p>刷新页面，可以看到jenkins已经从gitlab上拉取代码并传到了后端的tomcat服务器上</p>
<p><img src="img/5C1552654976723.png" alt="1552654976723"></p>
<h2 id="4-3：pipline："><a href="#4-3：pipline：" class="headerlink" title="4.3：pipline："></a>4.3：pipline：</h2><p>官方介绍；<a href="https://jenkins.io/2.0/">https://jenkins.io/2.0/</a> </p>
<p>pipline是帮助Jenkins实现CI到CD转变的重要角色，是运行在jenkins 2.X版本的核心插件，简单来说Pipline就是一套运行于Jenkins上的工作流框架，将原本独立运行于单个或者多个节点的任务连接起来，实现单个任务难以完成的复杂发布流程，从而实现单个任务很难实现的复杂流程编排和任务可视化，Pipeline的实现方式是一套Groovy DSL，任何发布流程都可以表述为一段Groovy脚本。</p>
<h3 id="4-3-1：pipline优势："><a href="#4-3-1：pipline优势：" class="headerlink" title="4.3.1：pipline优势："></a>4.3.1：pipline优势：</h3><p>可持续性：jenkins的重启或者中断后不影响已经执行的Pipline Job</p>
<p>支持暂停：pipline可以选择停止并等待人工输入或批准后再继续执行。</p>
<p>可扩展：通过groovy的编程更容易的扩展插件。</p>
<p>并行执行：通过groovy脚本可以实现step，stage间的并行执行，和更复杂的相互依赖关系。</p>
<h3 id="4-3-2：pipline-语法："><a href="#4-3-2：pipline-语法：" class="headerlink" title="4.3.2：pipline 语法："></a>4.3.2：pipline 语法：</h3><p>Stage：阶段，一个pipline可以划分为若干个stage，每个stage都是一个操作，比如clone代码、代码编译、代码测试和代码部署，阶段是一个逻辑分组，可以跨多个node执行。</p>
<p>Node：节点，每个node都是一个jenkins节点，可以是jenkins  master也可以是jenkins  agent，node是执行step的具体服务器。</p>
<p>Step：步骤，step是jenkins pipline最基本的操作单元，从在服务器创建目录到构建容器镜像，由各类</p>
<p>Jenkins 插件提供实现，例如： sh “make”</p>
<h3 id="4-3-2：pipline-job测试："><a href="#4-3-2：pipline-job测试：" class="headerlink" title="4.3.2：pipline job测试："></a>4.3.2：pipline job测试：</h3><h4 id="4-3-2-1：创建pipline-job："><a href="#4-3-2-1：创建pipline-job：" class="headerlink" title="4.3.2.1：创建pipline job："></a>4.3.2.1：创建pipline job：</h4><h4 id="4-3-2-2：测试简单pipline-job运行："><a href="#4-3-2-2：测试简单pipline-job运行：" class="headerlink" title="4.3.2.2：测试简单pipline job运行："></a>4.3.2.2：测试简单pipline job运行：</h4><p>node {</p>
<p>​    stage(“clone 代码”){</p>
<p>​       echo “代码clone”</p>
<p>​    }</p>
<p>​    stage(“代码构建”){</p>
<p>​       echo “代码构建”</p>
<p>​    }</p>
<p>   stage(“代码测试”){</p>
<p>​       echo “代码测试”</p>
<p>   }</p>
<p>   stage(“代码部署”){</p>
<p>​     echo “代码部署”</p>
<p>   }</p>
<p>}</p>
<h4 id="4-3-2-3：执行pipline-job："><a href="#4-3-2-3：执行pipline-job：" class="headerlink" title="4.3.2.3：执行pipline job："></a>4.3.2.3：执行pipline job：</h4><h4 id="4-3-2-4：生成拉取代码的pipline脚本："><a href="#4-3-2-4：生成拉取代码的pipline脚本：" class="headerlink" title="4.3.2.4：生成拉取代码的pipline脚本："></a>4.3.2.4：生成拉取代码的pipline脚本：</h4><h4 id="4-3-2-5：更改pipline-job："><a href="#4-3-2-5：更改pipline-job：" class="headerlink" title="4.3.2.5：更改pipline job："></a>4.3.2.5：更改pipline job：</h4><p>node {</p>
<p>   stage(“code clone”){</p>
<p>​       echo “git clone”</p>
<p>​       git credentialsId: ‘b695c060-6a99-4ee3-bd4c-730bd4dd36ec’, url: <a href="mailto:&#39;git@192.168.8.3">&#39;git@192.168.8.3</a>:test-service/test-project.git’</p>
<p>   }</p>
<p>  stage(“code build”){</p>
<p>​      echo “code build”</p>
<p>  }</p>
<p>  stage(“code test”){</p>
<p>​      echo “code test”</p>
<p>  }</p>
<p>  stage(“code deploy”){</p>
<p>​      echo “code deploy”</p>
<p>  }</p>
<p>}</p>
<h4 id="4-3-2-6：执行jenkins-job："><a href="#4-3-2-6：执行jenkins-job：" class="headerlink" title="4.3.2.6：执行jenkins job："></a>4.3.2.6：执行jenkins job：</h4><h4 id="4-3-2-7：验证git-clone日志："><a href="#4-3-2-7：验证git-clone日志：" class="headerlink" title="4.3.2.7：验证git clone日志："></a>4.3.2.7：验证git clone日志：</h4><h4 id="4-3-2-8：服务器验证数据："><a href="#4-3-2-8：服务器验证数据：" class="headerlink" title="4.3.2.8：服务器验证数据："></a>4.3.2.8：服务器验证数据：</h4><h4 id="4-3-2-9：pipline中执行shell-命令："><a href="#4-3-2-9：pipline中执行shell-命令：" class="headerlink" title="4.3.2.9：pipline中执行shell 命令："></a>4.3.2.9：pipline中执行shell 命令：</h4><p>node {</p>
<p>   stage(“code clone”){</p>
<p>​       echo “git clone”</p>
<p>​       git credentialsId: ‘b695c060-6a99-4ee3-bd4c-730bd4dd36ec’, url: <a href="mailto:&#39;git@192.168.8.3">&#39;git@192.168.8.3</a>:test-service/test-project.git’</p>
<p>​       sh “cd /root/.jenkins/workspace/pipline-test &amp;&amp; tar czvf code.tar.gz ./*”</p>
<p>   }</p>
<p>  stage(“code build”){</p>
<p>​      echo “code build”</p>
<p>  }</p>
<p>  stage(“code test”){</p>
<p>​      echo “code test”</p>
<p>  }</p>
<p>  stage(“code deploy”){</p>
<p>​      echo “code deploy”</p>
<p>  }</p>
<p>}</p>
<h3 id="4-3-3：jenkins-分布式构建："><a href="#4-3-3：jenkins-分布式构建：" class="headerlink" title="4.3.3：jenkins 分布式构建："></a>4.3.3：jenkins 分布式构建：</h3><h4 id="4-3-3-1：添加slave节点："><a href="#4-3-3-1：添加slave节点：" class="headerlink" title="4.3.3.1：添加slave节点："></a>4.3.3.1：添加slave节点：</h4><p>Jenkins—系统管理—节点管理—新建节点：</p>
<p>添加slave节点：</p>
<h4 id="4-3-3-2：配置slave节点："><a href="#4-3-3-2：配置slave节点：" class="headerlink" title="4.3.3.2：配置slave节点："></a>4.3.3.2：配置slave节点：</h4><p>Slave服务器创建工作目录，如果slave需要执行编译job，则也需要配置java环境：</p>
<p>[root@jenkins-slave ~]# yum install java-1.8.0-openjdk –y</p>
<p>[root@jenkins-slave ~]#  mkdir /data/jenkins/slave -pv</p>
<p>mkdir: created directory ‘/data’</p>
<p>mkdir: created directory ‘/data/jenkins’</p>
<p>mkdir: created directory ‘/data/jenkins/slave’</p>
<h4 id="4-3-3-3：添加slave认证凭据："><a href="#4-3-3-3：添加slave认证凭据：" class="headerlink" title="4.3.3.3：添加slave认证凭据："></a>4.3.3.3：添加slave认证凭据：</h4><h3 id="4-3-3-：添加slave节点："><a href="#4-3-3-：添加slave节点：" class="headerlink" title="4.3.3.：添加slave节点："></a>4.3.3.：添加slave节点：</h3><h3 id="4-3-4：jenkins-slave创建日志："><a href="#4-3-4：jenkins-slave创建日志：" class="headerlink" title="4.3.4：jenkins slave创建日志："></a>4.3.4：jenkins slave创建日志：</h3><h3 id="4-3-5：如果slave-java报错如下："><a href="#4-3-5：如果slave-java报错如下：" class="headerlink" title="4.3.5：如果slave java报错如下："></a>4.3.5：如果slave java报错如下：</h3><h3 id="4-3-6：验证slave-状态："><a href="#4-3-6：验证slave-状态：" class="headerlink" title="4.3.6：验证slave 状态："></a>4.3.6：验证slave 状态：</h3><p>正常状态：</p>
<p>时间不同步状态</p>
<h3 id="4-3-7：slave-状态："><a href="#4-3-7：slave-状态：" class="headerlink" title="4.3.7：slave 状态："></a>4.3.7：slave 状态：</h3><h3 id="4-3-8：配置slave执行job："><a href="#4-3-8：配置slave执行job：" class="headerlink" title="4.3.8：配置slave执行job："></a>4.3.8：配置slave执行job：</h3><p>Slave的公钥也要同步到各个web服务器</p>
<p>node(‘slave-node1’){</p>
<p>   stage(“code clone”){</p>
<p>​       echo “git clone”</p>
<p>​       sh “cd /data/jenkins/slave/workspace/pipline-test &amp;&amp; rm -rf ./*”</p>
<p>​       git credentialsId: ‘b695c060-6a99-4ee3-bd4c-730bd4dd36ec’, url: <a href="mailto:&#39;git@192.168.8.3">&#39;git@192.168.8.3</a>:test-service/test-project.git’</p>
<p>​       sh “cd /data/jenkins/slave/workspace/pipline-test &amp;&amp; tar czvf code.tar.gz ./*”</p>
<p>   }</p>
<p>  stage(“code build”){</p>
<p>​      echo “code build”</p>
<p>  }</p>
<p>  stage(“code test”){</p>
<p>​      echo “code test”</p>
<p>  }</p>
<p>  stage(“code deploy”){</p>
<p>​      echo “code deploy”</p>
<p>  }</p>
<p>}</p>
<h3 id="4-3-9：验证slave执行构建："><a href="#4-3-9：验证slave执行构建：" class="headerlink" title="4.3.9：验证slave执行构建："></a>4.3.9：验证slave执行构建：</h3>
      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/11/11/Linux之花里胡哨/" rel="next" title="linux之花里胡哨">
                <i class="fa fa-chevron-left"></i> linux之花里胡哨
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/03/新装系统后必须做的几件事/" rel="prev" title="装centos系统后必须要做的几件事！！！">
                装centos系统后必须要做的几件事！！！ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/img/头像1.jpg"
               alt="醉生梦死" />
          <p class="site-author-name" itemprop="name">醉生梦死</p>
          <p class="site-description motion-element" itemprop="description">记住要仰望星空，不要低头看脚下。无论生活如何艰难，请保持一颗好奇心。你总会找到自己的路和属于你的成功。” ——史蒂芬·霍金</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">36</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#DevOps-之基于Jenkins实现的CI与CD"><span class="nav-number">1.</span> <span class="nav-text">DevOps 之基于Jenkins实现的CI与CD</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1：什么是DevOps："><span class="nav-number">1.1.</span> <span class="nav-text">1.1：什么是DevOps：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2：为什么要推广DevOps？"><span class="nav-number">1.2.</span> <span class="nav-text">1.2：为什么要推广DevOps？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3：传统技术团队："><span class="nav-number">1.3.</span> <span class="nav-text">1.3：传统技术团队：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4：DevOps技术团队："><span class="nav-number">1.4.</span> <span class="nav-text">1.4：DevOps技术团队：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-5：什么是持续集成-CI-Continuous-integration-："><span class="nav-number">1.5.</span> <span class="nav-text">1.5：什么是持续集成(CI-Continuous integration)：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-6：什么是持续部署-CD-continuous-deployment-："><span class="nav-number">1.6.</span> <span class="nav-text">1.6：什么是持续部署(CD-continuous deployment)：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-7：什么是持续交付-Continuous-Delivery-："><span class="nav-number">1.7.</span> <span class="nav-text">1.7：什么是持续交付(Continuous Delivery)：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-8：常见的部署方式："><span class="nav-number">1.8.</span> <span class="nav-text">1.8：常见的部署方式：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-9：常见的持续集成开源工具："><span class="nav-number">1.9.</span> <span class="nav-text">1.9：常见的持续集成开源工具：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-9-1：CVS-Concurrent-Version-System-："><span class="nav-number">1.9.1.</span> <span class="nav-text">1.9.1：CVS(Concurrent Version System)：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-9-2：SVN-Subversion-–集中式版本控制系统"><span class="nav-number">1.9.2.</span> <span class="nav-text">1.9.2：SVN(Subversion)–集中式版本控制系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-9-3：Gitlib—分布式版本控制系统"><span class="nav-number">1.9.3.</span> <span class="nav-text">1.9.3：Gitlib—分布式版本控制系统</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-10：版本控制系统分类："><span class="nav-number">1.10.</span> <span class="nav-text">1.10：版本控制系统分类：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-10-1：集中式版本控制系统："><span class="nav-number">1.10.1.</span> <span class="nav-text">1.10.1：集中式版本控制系统：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-10-2：分布式版本控制系统："><span class="nav-number">1.10.2.</span> <span class="nav-text">1.10.2：分布式版本控制系统：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二：Gitlab部署与使用："><span class="nav-number">2.</span> <span class="nav-text">二：Gitlab部署与使用：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1：下载并部署gitlab："><span class="nav-number">2.1.</span> <span class="nav-text">2.1：下载并部署gitlab：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-1：Ubuntu-系统环境准备："><span class="nav-number">2.1.1.</span> <span class="nav-text">2.1.1：Ubuntu 系统环境准备：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-1：配置ubuntu-远程连接："><span class="nav-number">2.1.1.1.</span> <span class="nav-text">2.1.1.1：配置ubuntu 远程连接：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-2：配置ubuntu网卡和主机名："><span class="nav-number">2.1.1.2.</span> <span class="nav-text">2.1.1.2：配置ubuntu网卡和主机名：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-3：配置ubuntu-仓库："><span class="nav-number">2.1.1.3.</span> <span class="nav-text">2.1.1.3：配置ubuntu 仓库：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-2：Centos-系统环境在准备："><span class="nav-number">2.1.2.</span> <span class="nav-text">2.1.2：Centos 系统环境在准备：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-1：gitlab配置："><span class="nav-number">2.1.2.1.</span> <span class="nav-text">2.1.3.1：gitlab配置：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-2：初始化服务："><span class="nav-number">2.1.2.2.</span> <span class="nav-text">2.1.3.2：初始化服务：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-3：验证gitlab启动完成："><span class="nav-number">2.1.2.3.</span> <span class="nav-text">2.1.3.3：验证gitlab启动完成：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-4：验证端口及状态："><span class="nav-number">2.1.2.4.</span> <span class="nav-text">2.1.3.4：验证端口及状态：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-5：登录gitlab-web界面："><span class="nav-number">2.1.2.5.</span> <span class="nav-text">2.1.3.5：登录gitlab web界面：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-6：登录gitlab："><span class="nav-number">2.1.2.6.</span> <span class="nav-text">2.1.3.6：登录gitlab：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-7：默认首页："><span class="nav-number">2.1.2.7.</span> <span class="nav-text">2.1.3.7：默认首页：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-8：关闭账号注册："><span class="nav-number">2.1.2.8.</span> <span class="nav-text">2.1.3.8：关闭账号注册：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-9：验证是否还有注册选项："><span class="nav-number">2.1.2.9.</span> <span class="nav-text">2.1.3.9：验证是否还有注册选项：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-10：创建git账户："><span class="nav-number">2.1.2.10.</span> <span class="nav-text">2.1.3.10：创建git账户：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-11：重新设置密码："><span class="nav-number">2.1.2.11.</span> <span class="nav-text">2.1.3.11：重新设置密码：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-12：创建组："><span class="nav-number">2.1.2.12.</span> <span class="nav-text">2.1.3.12：创建组：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-13：使用管理员创建项目："><span class="nav-number">2.1.2.13.</span> <span class="nav-text">2.1.3.13：使用管理员创建项目：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-14：将用户添加到组："><span class="nav-number">2.1.2.14.</span> <span class="nav-text">2.1.3.14：将用户添加到组：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-15：git客户端测试clone项目："><span class="nav-number">2.1.2.15.</span> <span class="nav-text">2.1.3.15：git客户端测试clone项目：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-16-git-web端验证数据："><span class="nav-number">2.1.2.16.</span> <span class="nav-text">2.1.3.16:git web端验证数据：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-17：git常用命令："><span class="nav-number">2.1.2.17.</span> <span class="nav-text">2.1.3.17：git常用命令：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三：部署web服务器环境："><span class="nav-number">3.</span> <span class="nav-text">三：部署web服务器环境：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-部署tomcat环境"><span class="nav-number">3.0.0.1.</span> <span class="nav-text">3.1  部署tomcat环境</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">4.</span> <span class="nav-text">tomcat1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">5.</span> <span class="nav-text"></span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-部署keepalived"><span class="nav-number">5.0.0.1.</span> <span class="nav-text">3.2 部署keepalived</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3部署haproxy："><span class="nav-number">5.0.0.2.</span> <span class="nav-text">3.3部署haproxy：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-测试haproxy反向代理web服务器："><span class="nav-number">5.0.0.3.</span> <span class="nav-text">3.3.1: 测试haproxy反向代理web服务器：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-2-记录HAProxy访问日志："><span class="nav-number">5.0.0.4.</span> <span class="nav-text">3.3.2: 记录HAProxy访问日志：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-3-验证HAProxy统计页面："><span class="nav-number">5.0.0.5.</span> <span class="nav-text">3.3.3: 验证HAProxy统计页面：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-4-验证haproxy代理web服务器："><span class="nav-number">5.0.0.6.</span> <span class="nav-text">3.3.4.: 验证haproxy代理web服务器：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四：Jenkins部署与基础配置："><span class="nav-number">6.</span> <span class="nav-text">四：Jenkins部署与基础配置：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1：配置java环境并部署jenkins："><span class="nav-number">6.1.</span> <span class="nav-text">4.1：配置java环境并部署jenkins：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-1：java环境配置："><span class="nav-number">6.1.1.</span> <span class="nav-text">4.1.1：java环境配置：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-2：启动Jenkins"><span class="nav-number">6.1.2.</span> <span class="nav-text">4.1.2：启动Jenkins</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-2-1：通过jar包直接启动jenkins："><span class="nav-number">6.1.2.1.</span> <span class="nav-text">4.1.2.1：通过jar包直接启动jenkins：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-2-2：rpm包安装jenkins配置："><span class="nav-number">6.1.2.2.</span> <span class="nav-text">4.1.2.2：rpm包安装jenkins配置：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-3-Jenkins-启动过程："><span class="nav-number">6.1.3.</span> <span class="nav-text">4.1.3:Jenkins 启动过程：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-4：访问jenkins-页面"><span class="nav-number">6.1.4.</span> <span class="nav-text">4.1.4：访问jenkins 页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-5：选择安装jenkins插件："><span class="nav-number">6.1.5.</span> <span class="nav-text">4.1.5：选择安装jenkins插件：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-6：插件安装过程中："><span class="nav-number">6.1.6.</span> <span class="nav-text">4.1.6：插件安装过程中：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-7：创建jenkins管理员："><span class="nav-number">6.1.7.</span> <span class="nav-text">4.1.7：创建jenkins管理员：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-8：配置jenkins-URL："><span class="nav-number">6.1.8.</span> <span class="nav-text">4.1.8：配置jenkins URL：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-9：配置完成并登陆jenkins："><span class="nav-number">6.1.9.</span> <span class="nav-text">4.1.9：配置完成并登陆jenkins：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-10：登陆jenkins界面："><span class="nav-number">6.1.10.</span> <span class="nav-text">4.1.10：登陆jenkins界面：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-11：jenkins插件管理及安装："><span class="nav-number">6.1.11.</span> <span class="nav-text">4.1.11：jenkins插件管理及安装：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-11-1：插件安装目录："><span class="nav-number">6.1.11.1.</span> <span class="nav-text">4.1.11.1：插件安装目录：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-11-2：安装插件："><span class="nav-number">6.1.11.2.</span> <span class="nav-text">4.1.11.2：安装插件：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-12：配置jenkins-权限管理："><span class="nav-number">6.1.12.</span> <span class="nav-text">4.1.12：配置jenkins 权限管理：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-12-1：安装插件："><span class="nav-number">6.1.12.1.</span> <span class="nav-text">4.1.12.1：安装插件：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-12-2：创建新用户："><span class="nav-number">6.1.12.2.</span> <span class="nav-text">4.1.12.2：创建新用户：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-12-3：更改认证方式："><span class="nav-number">6.1.12.3.</span> <span class="nav-text">4.1.12.3：更改认证方式：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-12-4：创建角色："><span class="nav-number">6.1.12.4.</span> <span class="nav-text">4.1.12.4：创建角色：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-12-5：添加规则组："><span class="nav-number">6.1.12.5.</span> <span class="nav-text">4.1.12.5：添加规则组：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-12-6：对组分配权限："><span class="nav-number">6.1.12.6.</span> <span class="nav-text">4.1.12.6：对组分配权限：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-12-7：将用户关联到规则组："><span class="nav-number">6.1.12.7.</span> <span class="nav-text">4.1.12.7：将用户关联到规则组：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-12-8：测试普通用户登录："><span class="nav-number">6.1.12.8.</span> <span class="nav-text">4.1.12.8：测试普通用户登录：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-13：jenkins-邮箱配置："><span class="nav-number">6.1.13.</span> <span class="nav-text">4.1.13：jenkins 邮箱配置：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-13-1：生成QQ邮箱登录授权码："><span class="nav-number">6.1.13.1.</span> <span class="nav-text">4.1.13.1：生成QQ邮箱登录授权码：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-13-2：配置jenkins管理员邮箱："><span class="nav-number">6.1.13.2.</span> <span class="nav-text">4.1.13.2：配置jenkins管理员邮箱：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-13-3：发件配置："><span class="nav-number">6.1.13.3.</span> <span class="nav-text">4.1.13.3：发件配置：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-13-4：测试发送邮件："><span class="nav-number">6.1.13.4.</span> <span class="nav-text">4.1.13.4：测试发送邮件：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2：基于ssh-key拉取代码："><span class="nav-number">6.2.</span> <span class="nav-text">4.2：基于ssh key拉取代码：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1：添加ssh-key："><span class="nav-number">6.2.1.</span> <span class="nav-text">4.2.1：添加ssh key：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-2：添加ssh-key："><span class="nav-number">6.2.2.</span> <span class="nav-text">4.2.2：添加ssh key：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-3：创建ssh-key："><span class="nav-number">6.2.3.</span> <span class="nav-text">4.2.3：创建ssh key：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-4：测试ssh-key："><span class="nav-number">6.2.4.</span> <span class="nav-text">4.2.4：测试ssh key：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3：配置jenkins自动拉取代码："><span class="nav-number">6.3.</span> <span class="nav-text">4.3：配置jenkins自动拉取代码：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-1：jenkins-服务器添加证书："><span class="nav-number">6.3.1.</span> <span class="nav-text">4.3.1：jenkins 服务器添加证书：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-2：jenkins创建project："><span class="nav-number">6.3.2.</span> <span class="nav-text">4.3.2：jenkins创建project：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-3：配置git项目地址和用户："><span class="nav-number">6.3.3.</span> <span class="nav-text">4.3.3：配置git项目地址和用户：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-4：测试构建项目："><span class="nav-number">6.3.4.</span> <span class="nav-text">4.3.4：测试构建项目：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-4-1：点击立即构建："><span class="nav-number">6.3.4.1.</span> <span class="nav-text">4.3.4.1：点击立即构建：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-4-2：验证构建结果："><span class="nav-number">6.3.4.2.</span> <span class="nav-text">4.3.4.2：验证构建结果：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-4-3：服务器验证数据："><span class="nav-number">6.3.4.3.</span> <span class="nav-text">4.3.4.3：服务器验证数据：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-4-4：将代码部署至后端服务器："><span class="nav-number">6.3.4.4.</span> <span class="nav-text">4.3.4.4：将代码部署至后端服务器：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3：pipline："><span class="nav-number">6.4.</span> <span class="nav-text">4.3：pipline：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-1：pipline优势："><span class="nav-number">6.4.1.</span> <span class="nav-text">4.3.1：pipline优势：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-2：pipline-语法："><span class="nav-number">6.4.2.</span> <span class="nav-text">4.3.2：pipline 语法：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-2：pipline-job测试："><span class="nav-number">6.4.3.</span> <span class="nav-text">4.3.2：pipline job测试：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-1：创建pipline-job："><span class="nav-number">6.4.3.1.</span> <span class="nav-text">4.3.2.1：创建pipline job：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-2：测试简单pipline-job运行："><span class="nav-number">6.4.3.2.</span> <span class="nav-text">4.3.2.2：测试简单pipline job运行：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-3：执行pipline-job："><span class="nav-number">6.4.3.3.</span> <span class="nav-text">4.3.2.3：执行pipline job：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-4：生成拉取代码的pipline脚本："><span class="nav-number">6.4.3.4.</span> <span class="nav-text">4.3.2.4：生成拉取代码的pipline脚本：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-5：更改pipline-job："><span class="nav-number">6.4.3.5.</span> <span class="nav-text">4.3.2.5：更改pipline job：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-6：执行jenkins-job："><span class="nav-number">6.4.3.6.</span> <span class="nav-text">4.3.2.6：执行jenkins job：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-7：验证git-clone日志："><span class="nav-number">6.4.3.7.</span> <span class="nav-text">4.3.2.7：验证git clone日志：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-8：服务器验证数据："><span class="nav-number">6.4.3.8.</span> <span class="nav-text">4.3.2.8：服务器验证数据：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-2-9：pipline中执行shell-命令："><span class="nav-number">6.4.3.9.</span> <span class="nav-text">4.3.2.9：pipline中执行shell 命令：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-3：jenkins-分布式构建："><span class="nav-number">6.4.4.</span> <span class="nav-text">4.3.3：jenkins 分布式构建：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-3-1：添加slave节点："><span class="nav-number">6.4.4.1.</span> <span class="nav-text">4.3.3.1：添加slave节点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-3-2：配置slave节点："><span class="nav-number">6.4.4.2.</span> <span class="nav-text">4.3.3.2：配置slave节点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-3-3：添加slave认证凭据："><span class="nav-number">6.4.4.3.</span> <span class="nav-text">4.3.3.3：添加slave认证凭据：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-3-：添加slave节点："><span class="nav-number">6.4.5.</span> <span class="nav-text">4.3.3.：添加slave节点：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-4：jenkins-slave创建日志："><span class="nav-number">6.4.6.</span> <span class="nav-text">4.3.4：jenkins slave创建日志：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-5：如果slave-java报错如下："><span class="nav-number">6.4.7.</span> <span class="nav-text">4.3.5：如果slave java报错如下：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-6：验证slave-状态："><span class="nav-number">6.4.8.</span> <span class="nav-text">4.3.6：验证slave 状态：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-7：slave-状态："><span class="nav-number">6.4.9.</span> <span class="nav-text">4.3.7：slave 状态：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-8：配置slave执行job："><span class="nav-number">6.4.10.</span> <span class="nav-text">4.3.8：配置slave执行job：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-9：验证slave执行构建："><span class="nav-number">6.4.11.</span> <span class="nav-text">4.3.9：验证slave执行构建：</span></a></li></ol></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">醉生梦死</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  



  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  

  

  

</body>
</html>
